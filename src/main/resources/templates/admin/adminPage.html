<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin â€” FruitMarket</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <style>
        :root { --sidebar-w:260px; --accent:#198754; --muted:#6c757d; --card-radius:12px; }
        body { background:#f6faf6; min-height:100vh; }
        .admin-wrap { display:flex; gap:24px; padding:24px; }
        aside.sidebar { width:var(--sidebar-w); background:#fff; border-radius:var(--card-radius); padding:18px; box-shadow:0 6px 18px rgba(0,0,0,0.06); height:calc(100vh - 48px); position:sticky; top:24px; display:flex; flex-direction:column; }
        aside.sidebar header { font-weight:700; color:var(--accent); font-size:1.05rem; padding-bottom:6px; border-bottom:1px solid #f0f0f0; }
        aside.sidebar nav { display:flex; flex-direction:column; gap:6px; margin-top:8px; }
        .nav-link { display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:8px; color:#333; text-decoration:none; font-weight:600; }
        .nav-link:hover { background:#f2fff5; color:var(--accent); }
        .nav-link.active { background:rgba(25,135,84,0.08); color:var(--accent); box-shadow:inset 0 0 0 1px rgba(25,135,84,0.06); }
        aside.sidebar footer { margin-top:auto; font-size:0.85rem; color:var(--muted); }
        main.admin-main { flex:1; min-height:calc(100vh - 48px); }
        .primary-frame { width:100%; height:calc(100vh - 220px); border:none; border-radius:10px; box-shadow:0 6px 18px rgba(7,7,7,0.06); }
        .small-muted { color:var(--muted); font-size:.9rem; }
        @media (max-width:980px) { .admin-wrap { padding:12px; flex-direction:column; } aside.sidebar { position:relative; width:100%; height:auto; top:unset; } .primary-frame { height:60vh; } }
    </style>
</head>
<body>

<div th:replace="~{fragments/header :: header}"></div>
<div th:replace="~{fragments/notification :: notification}"></div>

<div class="admin-wrap container-fluid">
    <aside class="sidebar">
        <header>FruitMarket â€” Admin</header>

        <nav>
            <a href="#" class="nav-link active" data-src="/admin/products" title="Danh sÃ¡ch sáº£n pháº©m">ğŸ§¾ Products</a>
            <a href="#" class="nav-link" data-src="/admin/categories" title="Quáº£n lÃ½ danh má»¥c">ğŸ“‚ Categories</a>
            <a href="#" class="nav-link" data-src="/admin/brands" title="Quáº£n lÃ½ thÆ°Æ¡ng hiá»‡u">ğŸ·ï¸ Brands</a>
            <a href="#" class="nav-link" data-src="/admin/orders" title="Quáº£n lÃ½ Ä‘Æ¡n hÃ ng">ğŸ§¾ Orders</a>
            <a href="#" class="nav-link" data-src="/admin/userManagement" title="Quáº£n lÃ½ ngÆ°á»i dÃ¹ng">ğŸ‘¥ Users</a>
        </nav>

        <div class="small-muted" style="margin-top:12px;">
            <div>ÄÄƒng nháº­p: <strong th:text="${loggedUserName != null ? loggedUserName : 'admin'}">admin</strong></div>
            <div style="margin-top:8px;">
                <a th:href="@{/}" class="small-muted">Xem website</a> â€¢ <a th:href="@{/auth/logout}" class="small-muted">Logout</a>
            </div>
        </div>

        <footer>Â© 2025 FruitMarket</footer>
    </aside>

    <main class="admin-main">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
                <h2 id="pageTitle" class="m-0">Danh sÃ¡ch Products</h2>
                <div id="pageDesc" class="small-muted">Quáº£n lÃ½ sáº£n pháº©m: xem, sá»­a, táº¡o, xÃ³a.</div>
            </div>

            <div>
                <a id="btnCreate" class="btn btn-sm btn-success" href="#" role="button">â• ThÃªm sáº£n pháº©m</a>
                <a id="btnProducts" class="btn btn-sm btn-outline-primary" href="#" role="button">ğŸ§¾ Danh sÃ¡ch sáº£n pháº©m</a>
            </div>
        </div>

        <div id="frameWrap">
            <iframe id="adminFrame" class="primary-frame" src="/admin/products"></iframe>
        </div>
    </main>
</div>

<div th:replace="~{fragments/footer :: footer}"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    (function () {
        const links = Array.from(document.querySelectorAll('aside.sidebar .nav-link'));
        const frame = document.getElementById('adminFrame');
        const pageTitle = document.getElementById('pageTitle');
        const pageDesc = document.getElementById('pageDesc');

        function setActive(el) { links.forEach(l=>l.classList.remove('active')); if(el) el.classList.add('active'); }

        links.forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const src = this.getAttribute('data-src');
                if (!src) return;
                setActive(this);
                pageTitle.textContent = this.textContent.trim();
                pageDesc.textContent = 'Quáº£n lÃ½ ' + this.textContent.trim() + '.';
                frame.src = src;
            });
        });

        document.getElementById('btnCreate').addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelector('aside.sidebar .nav-link[data-src="/admin/products/create"]').click();
        });
        document.getElementById('btnProducts').addEventListener('click', function (e) { e.preventDefault(); document.querySelector('aside.sidebar .nav-link[data-src="/admin/products"]').click(); });

        function adjustFrameHeight() {
            const available = window.innerHeight - 220;
            frame.style.height = (available > 300 ? available : 400) + 'px';
        }
        window.addEventListener('resize', adjustFrameHeight);
        adjustFrameHeight();
    })();
</script>
</body>
</html>
