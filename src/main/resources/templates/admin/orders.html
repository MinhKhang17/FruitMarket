<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Qu·∫£n l√Ω ƒê∆°n h√†ng</title>
    <style>
        /* ===== Modern Green Theme - Orders (gi·ªØ y nguy√™n style b·∫°n c√≥) ===== */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        :root { --green-50:#f0fdf4; --green-100:#d1fae5; --green-500:#10b981; --green-600:#059669; --green-700:#047857; --shadow-sm:0 1px 3px rgba(0,0,0,0.05); --shadow-md:0 4px 12px rgba(0,0,0,0.08); --shadow-lg:0 10px 30px rgba(0,0,0,0.12); --transition:all .3s cubic-bezier(.4,0,.2,1); }
        html,body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,var(--green-50)0%,#ecfdf5 100%);min-height:100vh;color:#1f2937;}
        body{padding:24px;}
        .card{background:white;padding:28px 32px;border-radius:16px;box-shadow:var(--shadow-lg);max-width:1400px;margin:0 auto;border:1px solid rgba(16,185,129,0.1);animation:fadeIn .5s ease;}
        h2{color:#1f2937;font-weight:800;margin-bottom:24px;font-size:1.75rem;}
        .top-row{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:20px;}
        table{width:100%;border-collapse:separate;border-spacing:0;border-radius:12px;box-shadow:var(--shadow-md);overflow:hidden;background:white;}
        thead th{background:linear-gradient(135deg,var(--green-100)0%,#a7f3d0 100%);color:var(--green-700);font-weight:700;text-align:left;padding:14px 16px;font-size:13px;text-transform:uppercase;letter-spacing:.5px;}
        tbody td{padding:14px 16px;font-size:14px;border-bottom:1px solid #f3f4f6;}
        tbody tr:hover{background:#f9fafb;transition:background .2s ease;}
        .price{font-weight:700;color:var(--green-700);}
        .status-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;white-space:nowrap;}
        .status-pending{background:#fef3c7;color:#92400e}
        .status-shipping{background:#d1fae5;color:#065f46}
        .status-delivered{background:#d1fae5;color:#047857}
        .status-cancelled{background:#fee2e2;color:#991b1b}
        .paid-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;white-space:nowrap;}
        .paid-yes{background:#d1fae5;color:#047857}
        .paid-no{background:#fee2e2;color:#991b1b}
        .product-info{display:flex;align-items:center;gap:12px}
        .product-img{width:60px;height:60px;object-fit:cover;border-radius:8px;border:2px solid #e5e7eb}
        .btn-view{display:inline-block;background:linear-gradient(135deg,var(--green-500)0%,var(--green-600)100%);color:white;padding:8px 16px;border-radius:8px;text-decoration:none;font-weight:600;border:none;cursor:pointer}
        .no-data{text-align:center;padding:60px 20px;color:#6b7280;font-size:15px}
        @media(max-width:720px){body{padding:16px}.card{padding:20px}th,td{padding:10px 12px;font-size:13px}h2{font-size:1.5rem}.btn-view{width:100%}}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    </style>
</head>
<body>
<div class="card">
    <div class="top-row">
        <h2>üì¶ Qu·∫£n l√Ω ƒê∆°n h√†ng</h2>
    </div>

    <div th:if="${message}" th:class="'alert alert-' + ${type}" style="padding: 12px; margin-bottom: 16px; border-radius: 6px;">
        <span th:text="${message}"></span>
    </div>

    <!-- Table -->
    <table th:if="${orders != null and !orders.isEmpty()}">
        <thead>
        <tr>
            <th>ID</th>
            <th>Kh√°ch h√†ng</th>
            <th>S·ªë ƒëi·ªán tho·∫°i</th>
            <th>ƒê·ªãa ch·ªâ</th>
            <th>T·ªïng ti·ªÅn</th>
            <th>S·ªë s·∫£n ph·∫©m</th>
            <th>Thanh to√°n</th>
            <th>Tr·∫°ng th√°i</th>
            <th>H√†nh ƒë·ªông</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="order : ${orders}">
            <td th:text="${order.id}">1</td>

            <!-- Safe username -->
            <td th:text="${order.users != null ? order.users.username : 'N/A'}">user</td>

            <td th:text="${order.phoneNumber}">0933...</td>

            <!-- abbreviate address safely -->
            <td th:text="${#strings.abbreviate(order.address,30)}">1 M·∫°c Thi√™n...</td>

            <!-- format totalPrice as VND (use COMMA as thousands separator) -->
            <td class="price"
                th:text="${order.totalPrice != null ? #numbers.formatDecimal(order.totalPrice, 0, 'COMMA', 0, 'POINT') + ' ‚Ç´' : '‚Äî'}">
                0 ‚Ç´
            </td>

            <!-- use totalQuantity (you already have this field on Order) -->
            <td th:text="${order.totalQuantity}">0</td>

            <!-- paid badge -->
            <td>
                <span th:class="${order.paid ? 'paid-badge paid-yes' : 'paid-badge paid-no'}"
                      th:text="${order.paid ? 'ƒê√£ thanh to√°n' : 'Ch∆∞a thanh to√°n'}">Ch∆∞a thanh to√°n</span>
            </td>

            <!-- status badge: build class from enum name (lowercase) if present -->
            <td>
                <span th:class="'status-badge ' + (order.orderStauts != null ? 'status-' + ${order.orderStauts.name().toLowerCase()} : '')"
                      th:text="${order.orderStauts != null ? order.orderStauts : '‚Äî'}">PENDING</span>
            </td>

            <td>
                <a th:href="@{/admin/orders/{id}(id=${order.id})}" class="btn-view">Xem chi ti·∫øt</a>
            </td>
        </tr>
        </tbody>
    </table>

    <div th:if="${orders == null or orders.isEmpty()}" class="no-data">
        <p>üì≠ Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</p>
    </div>
</div>
</body>
</html>
