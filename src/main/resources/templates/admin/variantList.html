<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Danh sách biến thể</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link th:href="@{/variant-list.css}" rel="stylesheet"/>
</head>

<body>
<div class="card">
    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
        <div>
            <h3 th:text="'Danh sách biến thể của: ' + ${product.productName}"></h3>
            <p class="text-muted" th:text="'Mã sản phẩm: ' + ${product.id}"></p>
        </div>
        <div class="d-flex gap-2">
            <a th:href="@{/admin/products}" class="btn btn-outline-light btn-sm">← Danh sách sản phẩm</a>
            <a th:href="@{'/admin/products/' + ${product.id} + '/variants'}" class="btn btn-green btn-sm">+ Thêm biến thể</a>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(product.variants)}" class="empty">
        Chưa có biến thể nào.
    </div>

    <table th:if="${!#lists.isEmpty(product.variants)}">
        <thead>
        <tr>
            <th>#</th>
            <th>Image</th>
            <th>Type of variant</th>
            <th>Price (₫)</th>
            <th>Stock</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="v,iter : ${product.variants}"
            th:if="${v.status != T(com.example.fruitmarket.enums.ProductStatus).INACTIVE}">
            <td th:text="${iter.index + 1}"></td>
            <td>
                <img th:if="${v.image != null}" th:src="${v.image.url}" class="thumb" alt="variant"
                     onerror="this.src='/images/placeholder.png'"/>
                <span th:if="${v.image == null}" class="text-muted">—</span>
            </td>
            <td th:text="${v.variant_name}">Variant</td>
            <td th:text="${#numbers.formatDecimal(v.price, 0, 'COMMA', 2, 'POINT')}"></td>
            <td th:text="${v.stock}"></td>
            <td>
                <a th:href="@{'/admin/productVariant/delete/' + ${v.id}}"
                   class="text-danger"
                   onclick="return confirm('Xác nhận xóa biến thể này?')">Xóa</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>
