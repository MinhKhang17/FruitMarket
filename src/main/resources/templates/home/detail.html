<!-- file: src/main/resources/templates/home/detail.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title th:text="${product.product_name} + ' — Detail'">Product Detail</title>
    <base target="_top">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- CSS riêng của trang Detail (vibe xanh lá) -->
    <link th:href="@{/css/detail.css}" rel="stylesheet"/>
</head>
<body>

<div th:replace="fragments/header :: header"></div>

<main class="page">
    <div class="container" th:object="${product}">
        <div class="detail-card">
            <div class="row g-4 align-items-start">

                <!-- Left: Image -->
                <div class="col-lg-6">
                    <div class="img-wrap">
                        <!-- Nếu Product có Image (OneToOne) -> show image.url, nếu không -> placeholder -->
                        <img th:src="${product.images == null ? '/images/placeholder.png' : product.images.url}"
                             th:alt="${product.product_name}"
                             class="img-fluid rounded"/>
                    </div>
                </div>

                <!-- Right: Content -->
                <div class="col-lg-6">
                    <h1 class="title h3 mb-2" th:text="*{product_name}">Product name</h1>

                    <div class="mb-3">
                        <span class="price"
                              th:text="${
                                  (product.variants != null && !#lists.isEmpty(product.variants))
                                  ? #numbers.formatDecimal(#lists.first(product.variants).price,0,'COMMA',2,'POINT')
                                  : (product.product_price != null ? #numbers.formatDecimal(product.product_price,0,'COMMA',2,'POINT') : '—')
                              }">0.00</span>
                    </div>

                    <p class="text-dark mb-3" th:text="*{product_description}">
                        Description
                    </p>

                    <div class="meta mb-3">
                        <p class="mb-1">
                            <strong>Category: </strong>
                            <span th:text="${product.category != null ? product.category.name : '—'}">Category</span>
                        </p>
                        <p class="mb-1">
                            <strong>Brand: </strong>
                            <span th:text="${product.brand != null ? product.brand.name : '—'}">Brand</span>
                        </p>
                    </div>

                    <div class="d-flex gap-2 mt-4">
                        <!-- Nếu trang list là "/" thì có thể đổi th:href="@{ / }" -->
                        <a class="btn btn-ghost" th:href="@{/}">Back to list</a>
                        <a class="btn btn-leaf" th:href="@{|/products/${product.id}/buy|}">Buy now</a>
                    </div>
                </div>

            </div>
        </div>
    </div>
</main>

<div th:replace="fragments/footer :: footer"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
